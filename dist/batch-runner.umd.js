!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).batchRunner=e()}(this,function(){"use strict";return function(){const n=new Map,e=Symbol("missing");function t(t){let{name:o,source:i,job:f,final:u}=t;return null==i&&(i=()=>e),null==u&&(u=()=>e),"string"==typeof o&&("function"==typeof i&&("function"==typeof f&&("function"==typeof u&&(n.set(o,{name:o,source:i,job:f,final:u}),!0))))}return{define:t,run:function(o,...i){if("string"!=typeof o){const{name:n}=o;t(o),o=n}const f=n.get(o);if(null==f)return[];const{source:u,job:r,final:s}=f,l=Symbol("end___"),c=[];let p=u(...i||[]);p===e&&(p=[void 0]),void 0!==p&&p.hasOwnProperty("length")&&"string"!=typeof p||(p=[p]);for(let[n,e]of p.entries()){let t=r({item:e,i:n,END:l},...i);if(t===l)break;c.push(t)}const d=s(c,...i);return d!==e?d:c}}}});
